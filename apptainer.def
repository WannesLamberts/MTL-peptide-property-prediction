From: continuumio/miniconda3

%post
    # Set working directory inside the container
    mkdir -p /app
    cd /app

    # Create conda environment and clean up
    conda env create -f /app/environment.yml && \
    conda clean --all -y

%environment
    # Activate the conda environment when entering the container
    export PATH="/opt/conda/envs/MTL-pep-prop/bin:$PATH"

%files
    # Copy the entire project (including environment.yml) into the container's /app directory
    . /app

WORKDIR /app  # This ensures the working directory is set to /app

%runscript
    # Default command that runs when the container is executed
    exec python /app/main.py  # Replace with the appropriate command for your project
